# Машинне навчання

Іншим важливим застосуванням даних є машинне навчання. Це область штучного інтелекту, присвячена алгоритмам, які розвиваються завдяки наданим даним. Нам буде легше зрозуміти, що&nbsp;це, коли ми&nbsp;побачимо кілька прикладів.

## Приклади використання штучного інтелекту

Штучний інтелект часто асоціюється з&nbsp;іграми, тобто грою проти так званого "комп’ютера". Для створення таких алгоритмів справді часто використовується машинне навчання. Часто на&nbsp;початку записується певна кількість ігор між людьми. Алгоритм навчається поводитися якомога подібніше. Потім можна симулювати ігри між різними алгоритмами та&nbsp;навчати їх на&nbsp;основі перемог чи поразок. Навчені таким чином алгоритми можуть стати набагато успішнішими за людей. Вже в&nbsp;1997 році штучний інтелект переміг шахового гросмейстера Гаррі Каспарова. У 2016 році комп’ютер переміг чемпіона світу з&nbsp;Ґо. Навіть у&nbsp;DOTA 2 алгоритми перевершили чемпіонів світу.

Дуже корисним застосуванням машинного навчання є розпізнавання зображень. Якщо відкрити програму Google Assistant на&nbsp;телефоні з&nbsp;ОС Android, увімкнути режим камери і направити об’єктив на&nbsp;друкований текст, програма розпізнає написаний текст. Раніше я часто використовував цю функцію за кордоном для перекладу меню в&nbsp;закладах харчування. Алгоритми вчаться розпізнавати текст завдяки численим прикладам. Розпізнавання зображень використовується в&nbsp;багатьох інших сферах. Наприклад, існують алгоритми, навчені розпізнавати пухлини на&nbsp;основі зображень знімків УЗД або КТ. Деякі здатні розпізнати такі зміни на&nbsp;більш ранніх стадіях та&nbsp;зі статистично більшою точністю, ніж лікарі. Зрештою, вони вчилися на&nbsp;більшій кількості прикладів, аналізують кожен піксель і ніколи не&nbsp;втомлюються. Тому у&nbsp;все більшій кількості лікарень по&nbsp;всьому світу їх використовують для допомоги лікарям.

Компанії часто використовують машинне навчання для прогнозування майбутніх результатів продажів. Перш за все для навчання використовуються дані про саму компанію. Однак деякі фірми використовують також дані про економічну ситуацію на&nbsp;території, на&nbsp;якій вони працюють, прогнози інших компаній та&nbsp;багато іншого.

## Приклад проєкту

У нашому проєкті ми&nbsp;навчимо алгоритм розпізнавати написані від руки цифри. Таке розпізнавання може бути корисним у&nbsp;поштовому відділенні, щоб зчитувати поштові індекси, вписані у&nbsp;клітинки. Ми&nbsp;використаємо дуже популярний алгоритм, який називається нейронна мережа. На неї можна дивитися як&nbsp;на&nbsp;чорну скриньку, в&nbsp;яку ми&nbsp;кладемо приклади разом з&nbsp;інформацією про очікувану відповідь, а потім даємо команду вивчити ці приклади. Після цього мережа повинна добре відповідати на&nbsp;запитання про надані приклади, але, якщо вона добре узагальнить отримані дані, вона також повинна добре класифікувати [^401_1] приклади, яких вона раніше не&nbsp;бачила.

Ми будемо виконувати реалізацію цього алгоритму з&nbsp;пакету `sklearn` (його потрібно встановити). Що стосується фотографій текстів, ми&nbsp;використаємо набір, який входить у&nbsp;цей же пакет.

```python
from sklearn import datasets

digits = datasets.load_digits()
```

Цей набір чисел містить 1797 записів. Це небагато, тому що&nbsp;сучасні алгоритми навчаються на&nbsp;значно більших наборах. Крім того, ці знімки мають не&nbsp;дуже високу роздільну здатність. Тож це&nbsp;буде певним викликом.

{width: 80%}
![Перші цифри з&nbsp;нашого набору.](402_digits.png)

Перш ніж почати навчання, нам потрібно трохи трансформувати зображення. Зараз кожне зображення подане у&nbsp;вигляді списку в&nbsp;списку [^401_2]. Ми&nbsp;ж запишемо кожне зображення просто як&nbsp;список, який представляє усі пікселі по&nbsp;черзі.

```python
n_samples = len(digits.images)  # 1797
data = digits.images.reshape((n_samples, -1))
```

Після того, як&nbsp;ми&nbsp;навчимо нашу мережу, ми&nbsp;захочемо перевірити, як&nbsp;вона справляється з&nbsp;розпізнаванням чисел, яких вона раніше не&nbsp;бачила. Тому нам потрібно відкласти частину цифр для тестування. Дані, які використовуються для навчання, називаються **тренувальними** і матимуть закінчення `_train`. Ті ж, що&nbsp;використовуються для перевірки, називаються **випробувальними** і матимуть кінцівку `_test`. Змінна `X` представляє приклади, тобто в&nbsp;нашому випадку зображення, а `y` — відповіді. Щоб&nbsp;розділити наші дані на&nbsp;тренувальний та&nbsp;випробувальний набори, ми&nbsp;можемо використати функцію `train_test_split`. Відкладемо у&nbsp;випробувальний набір даних 30 % (тобто `0.3`) прикладів.

```python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    data, digits.target, test_size=0.3
)
```

Нарешті настав час&nbsp;створити нашу нейронну мережу та&nbsp;навчити її&nbsp;тренувальним прикладам. Ми&nbsp;будемо використовувати класичну нейронну мережу під назвою *багатошаровий перцептрон* (англ. Multi-Layer Perceptron, MLP). Для навчання використовується функція `fit`. Навчання може бути досить тривалим. Для великих мереж і наборів даних воно може зайняти навіть багато годин (з чим я зіштовхнувся під час&nbsp;написання дипломної роботи). Однак у&nbsp;нас невелика мережа і невеликий набір даних, тож все має пройти дуже швидко.

```python
from sklearn.neural_network import MLPClassifier

clf = MLPClassifier(hidden_layer_sizes=(100, 100))
clf.fit(X_train, y_train)
```

> `clf` — це&nbsp;скорочення від "класифікатор", тобто алгоритм, який розподіляє елементи за категоріями (у нашому випадку категорії — це&nbsp;різні цифри).

Почнімо з&nbsp;перевірки, чи справді наша мережа засвоїла тренувальний набір. Попросімо її&nbsp;розпізнати приклади з&nbsp;тренувального набору. Порівнявши результати з&nbsp;тренувальним набором, отримуємо 100 % точності.

```python
# y_train_pred i y_train to tablice z numpy
# порівняння також повертає таблицю
y_train_pred = clf.predict(X_train)
print((y_train_pred == y_train).mean())  # 1.0
```

Однак справжньою перевіркою буде кількість правильних відповідей щодо набору, якого машина не&nbsp;знала. Побачимо, як&nbsp;вона упорається з&nbsp;випробувальним набором даних.

```python
y_test_pred = clf.predict(X_test)
print((y_test_pred == y_test).mean())  # 0.988
```

Вона помилилася лише в&nbsp;1,2 % випадків. Це справді хороший результат, враховуючи якість знімків і невелику кількість тренувальних даних. У мене є великі сумніви, що&nbsp;людина впоралася б краще. Нижче я додаю кілька випадкових символів разом із відповідями, наданими нашим алгоритмом.

![](402_predicitons.png)

## Завершення

Машинне навчання — це, звичайно, масштабна тема. Однак варто ознайомитися з&nbsp;її можливостями та&nbsp;методами, адже воно стає все важливішим та&nbsp;може мати величезний вплив на&nbsp;наше майбутнє.

[^401_1]: **Класифікувати** — приписати до категорії, тобто в&nbsp;нашому випадку — розпізнати цифру.
[^401_2]: Двовимірне зображення можна уявити собі як&nbsp;величезну таблицю, де&nbsp;кожне значення визначає інтенсивність кольору в&nbsp;певному місці. Це дуже поширений формат опису зображень.



